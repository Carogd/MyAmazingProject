<!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <meta
        http-equiv="X-UA-Compatible"
        content="IE=edge"
      />
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0"
      />
      <title>Document</title>
      <link
        rel="stylesheet"
        href="style.css"
      />
    </head>
    <body>
      <div id="app">
        <section>
          <div class="row">
            <div
              class="col"
              v-for="post in postsList"
              :key="post.id"
            >
              <div class="card">
                <img
                  class="card-image"
                  src="https://picsum.photos/id/237/200/300"
                  alt="fake img"
                />
                <div class="card-body">
                  <h5 class="card-title">{{post.title}}</h5>
                  <p class="carttext">{{post.body}}</p>
                </div>
                <div class="card-footer">
                  <span>Nombre de like : {{post.likes ? post.likes : "0"}} like{{post.likes > 1 ? "s" : ""}}</span>
                  <button v-on:click="addLike(post)">Like </button>
                </div>
                <div class="comment" >
                  <form v-on:submit.prevent="(event) => addComment(event,post)">
                    <input type="text"  >
                  </form>
                  <div class="listComments" >
                    <div class="comment" v-for="comment in post.comments" :key="comment.id">
                      {{ comment.body }}
                      <button v-on:click="addLikeComment(comment)">Like the comment </button>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </section>
      </div>
      <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
      <script>
        const { createApp } = Vue;

        createApp({
          data() {
            return {
              postsList: [],
            };
          },
          methods: {
            addLike(post) {
              if (post.likes) {
                post.likes++;
              } else {
                post.likes = 1;
              }
            },
            addComment(event, post) {
              const { value } = event.target.elements[0];

              const comment = {
                // in order to hav a key to iterate and to be able to select this comment only if you want to do an action 
                id : post.comments ? post.comments.length + 1 : 1,
                body : value,
                likescomments: 0,
              }

              if (post.comments) {
                 post.comments.push(comment)
              } else {
                // init
                post.comments = [comment]
              }
            },
            addLikeComment(comment) {
              if (comment.likescomments) {
                comment.likescomments++;
              } else {
                comment.likescomments = 1;
              }
            },
          },
          mounted() {
            fetch("https://jsonplaceholder.typicode.com/posts")
              .then((response) => response.json())
              .then((data) => this.postsList.push(...data));
          },
        }).mount("#app");
      </script>
    </body>
  </html>
</html>
